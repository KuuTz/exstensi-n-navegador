(()=>{const e=document.querySelector(".form-data"),t=document.querySelector(".region-name"),o=document.querySelector(".api-key"),n=document.querySelector(".errors"),a=document.querySelector(".loading"),l=document.querySelector(".result-container"),r=document.querySelector(".carbon-usage"),s=document.querySelector(".fossil-fuel"),c=document.querySelector(".my-region"),i=document.querySelector(".clear-btn");async function u(t,o){try{await axios.get("https://api.co2signal.com/v1/latest",{params:{countryCode:o},headers:{"auth-token":t}}).then((t=>{let n=Math.floor(t.data.data.carbonIntensity);a.style.display="none",e.style.display="none",c.textContent=o,r.textContent=Math.round(t.data.data.carbonIntensity)+" grams (grams C02 emitted per kilowatt hour)",s.textContent=t.data.data.fossilFuelPercentage.toFixed(2)+"% (percentage of fossil fuels used to generate electricity)",l.style.display="block",y(n)}))}catch(e){console.log(e),a.style.display="none",l.style.display="none",n.textContent="Sorry, we have no data for the region you have requested."}}function d(){const t=localStorage.getItem("apiKey"),o=localStorage.getItem("regionName");null===t||null===o?(e.style.display="block",l.style.display="none",a.style.display="none",i.style.display="none",n.textContent=""):(u(t,o),l.style.display="none",e.style.display="none",i.style.display="block")}function y(e){let t=[0,150,600,750,800],o=t.sort(((t,o)=>Math.abs(t-e)-Math.abs(o-e)))[0],n=t.findIndex((e=>e>o)),a=["#2AA364","#F5EB4D","#9E4229","#381D02","#381D02"][n];console.log(n,a),chrome.runtime.sendMessage({action:"updateIcon",value:{color:a}})}e.addEventListener("submit",(e=>function(e){e.preventDefault(),function(e,t){localStorage.setItem("K71UuIz6FAPwZzdI7vTEU2bgBiCC4w3U",e),localStorage.setItem("MX-CE",t),a.style.display="block",n.textContent="",i.style.display="block",u(e,t)}(o.value,t.value)}(e))),i.addEventListener("click",(e=>function(e){e.preventDefault(),localStorage.removeItem("regionName"),d()}(e))),d(),chrome.runtime.sendMessage({action:"updateIcon",value:{color:"green"}}),y(CO2)})();